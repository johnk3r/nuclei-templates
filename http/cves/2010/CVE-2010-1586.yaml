id: CVE-2010-1586

info:
  name: HP System Management Homepage (SMH) v2.x.x.x - Open Redirect
  author: ctflearner
  severity: medium
  description: |
    Open redirect vulnerability in red2301.html in HP System Management Homepage (SMH) 2.x.x.x allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via the RedirectUrl parameter.
  remediation: |
    Apply the latest patches or updates provided by HP to fix the open redirect vulnerability.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1586
    - https://yehg.net/lab/pr0js/advisories/hp_system_management_homepage_url_redirection_abuse
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/58107
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cve-id: CVE-2010-1586
    cwe-id: CWE-20
    epss-score: 0.00917
    epss-percentile: 0.81041
    cpe: cpe:2.3:a:hp:system_management_homepage:2.0.0:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: hp
    product: system_management_homepage
  tags: cve,cve2010,redirect,smh,hp

http:
  - method: GET
    path:
      - "{{BaseURL}}/red2301.html?RedirectUrl=http://interact.sh"

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:http?://|//)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh.*$'
# digest: 4b0a00483046022100a3557e38fb3a680513c28e6426e2a0f543a5b9bc29500ca1431a375eda34b1b7022100bd7d1717f97cd81adc145de541515cb0e13bbbf2591bec2861a1fedfc119b4a6:922c64590222798bb761d5b6d8e72950